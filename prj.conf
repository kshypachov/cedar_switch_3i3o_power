CONFIG_THREAD_MONITOR=y
CONFIG_THREAD_NAME=y

CONFIG_PRINTK=y

CONFIG_MAIN_STACK_SIZE=8192
CONFIG_HEAP_MEM_POOL_SIZE=8192

CONFIG_NETWORKING=y
CONFIG_NET_IPV6=n
CONFIG_NET_IPV4=y
CONFIG_NET_ARP=y
CONFIG_NET_UDP=y
CONFIG_NET_TCP=y
CONFIG_NET_DHCPV4=y
CONFIG_NET_L2_ETHERNET=y
CONFIG_ETH_W5500=y

CONFIG_TEST_RANDOM_GENERATOR=y

CONFIG_INIT_STACKS=y

CONFIG_NET_MGMT=y
CONFIG_NET_MGMT_EVENT=y

CONFIG_NET_LOG=y
CONFIG_LOG=y

CONFIG_SLIP_STATISTICS=n
CONFIG_NET_SHELL=y

CONFIG_GPIO=y

# Flash support
CONFIG_FLASH=y
CONFIG_FLASH_PAGE_LAYOUT=y
CONFIG_FLASH_MAP=y
CONFIG_SPI_NOR=y
CONFIG_SPI_NOR_SFDP_DEVICETREE=n
CONFIG_SPI_NOR_SFDP_RUNTIME=y

# LittleFS
CONFIG_FILE_SYSTEM=y
CONFIG_FILE_SYSTEM_LITTLEFS=y

# SPI support
CONFIG_SPI=y

#CONFIG_CONSOLE=y
#CONFIG_UART_CONSOLE=n
#CONFIG_USB_DEVICE_STACK=y
#CONFIG_USB_CDC_ACM=y

#CONFIG_SERIAL=y
#CONFIG_USB_DEVICE_STACK=y
#CONFIG_USB_CDC_ACM=y
#CONFIG_UART_CONSOLE=y


#CONFIG_SERIAL=y
#CONFIG_USB_DEVICE_STACK=y
#CONFIG_USB_CDC_ACM=y

# Консоль через USB
#CONFIG_UART_CONSOLE=y

CONFIG_GPIO=y
CONFIG_LED=y
CONFIG_LED_GPIO=y

# ==== USB девайс ====
CONFIG_USB_DEVICE_STACK=y
CONFIG_USB_CDC_ACM=y

# Произвольные VID/PID; можно взять дефолт Zephyr VID
CONFIG_USB_DEVICE_VID=0x2FE3
CONFIG_USB_DEVICE_PID=0x0100
CONFIG_USB_DEVICE_PRODUCT="AQ Sensor"

# Консоль через USB CDC-ACM
CONFIG_CONSOLE=y
# отключаем обычную UART-консоль
CONFIG_UART_CONSOLE=n
CONFIG_PRINTK=y
CONFIG_LOG=y



# USB стек
CONFIG_USB_DEVICE_STACK=y
CONFIG_USB_DC_STM32=y
# замените на свои VID/PID
CONFIG_USB_DEVICE_VID=0x1209
CONFIG_USB_DEVICE_PID=0x0001
CONFIG_USB_DEVICE_MANUFACTURER="YourCompany"
CONFIG_USB_DEVICE_PRODUCT="AQ Sensor"

# CDC-ACM класс
CONFIG_USB_CDC_ACM=y
# можно так, либо вручную usb_enable()
CONFIG_USB_DEVICE_INITIALIZE_AT_BOOT=y

# Консоль/лог в CDC
CONFIG_CONSOLE=y
CONFIG_UART_CONSOLE=n
#CONFIG_USB_DEVICE_STACK_NEXT_DEVNAME=y
CONFIG_LOG=y
CONFIG_LOG_MODE_DEFERRED=y
#CONFIG_LOG_BACKEND_USB=y
CONFIG_LOG_PROCESS_THREAD=y

# Если VBUS не разведен на PA9 — отключить детект
#CONFIG_USB_DC_STM32_VBUS_SENSING=n

CONFIG_SPI=y
CONFIG_FLASH=y
CONFIG_FLASH_PAGE_LAYOUT=y
 # опционально, если дальше будете заводить партиции
CONFIG_FLASH_MAP=y

# Для SPI NOR драйвера:
CONFIG_SPI_NOR=y

CONFIG_FLASH_JESD216_API=y
CONFIG_SPI_NOR_SFDP_RUNTIME=y

CONFIG_NET_SHELL=y
CONFIG_KERNEL_SHELL=y
CONFIG_SHELL_BACKEND_TELNET=y
CONFIG_SHELL_TELNET_SUPPORT_COMMAND=y

CONFIG_ZBUS=y

# ФС: LittleFS
CONFIG_FILE_SYSTEM=y
CONFIG_FILE_SYSTEM_LITTLEFS=y
CONFIG_FS_LOG_LEVEL_DBG=y
#CONFIG_FS_LOG_LEVEL_ERR=y
#CONFIG_FS_LITTLEFS_CHECK_ALWAYS=y

# (Опционально) POSIX API — не обязателен, мы используем fs_*, но может пригодиться
CONFIG_POSIX_API=y

CONFIG_FLASH=y
# нужно для NVS по FIXED_PARTITION_ID
CONFIG_FLASH_MAP=y
CONFIG_SPI_NOR=y
#CONFIG_MTD=y
#CONFIG_MTD_SPI_NOR=y
CONFIG_FILE_SYSTEM=y
CONFIG_FILE_SYSTEM_LITTLEFS=y
# LittleFS поверх MTD-устройства
#CONFIG_FS_LITTLEFS_MTD=y
CONFIG_NVS=y
#CONFIG_SETTINGS=y
#CONFIG_SETTINGS_NVS=y
CONFIG_FLASH_PAGE_LAYOUT=y


CONFIG_FLASH=y
CONFIG_FLASH_MAP=y
CONFIG_FLASH_PAGE_LAYOUT=y
CONFIG_FILE_SYSTEM=y
CONFIG_FILE_SYSTEM_LITTLEFS=y
CONFIG_FILE_SYSTEM_MKFS=y
CONFIG_SPI_NOR_FLASH_LAYOUT_PAGE_SIZE=4096

CONFIG_NET_SOCKETS=y
CONFIG_NET_TCP=y
CONFIG_NET_UDP=y
CONFIG_NET_IPV4=y

CONFIG_NET_MGMT=y
CONFIG_NET_MGMT_EVENT=y

CONFIG_POSIX_API=y

# JSON
CONFIG_JSON_LIBRARY=y

CONFIG_SHELL_LOG_BACKEND=y

CONFIG_SETTINGS=y
CONFIG_SETTINGS_RUNTIME=y
CONFIG_SETTINGS_NVS=y

CONFIG_HTTP_SERVER=y
CONFIG_ZVFS_EVENTFD_MAX=2
CONFIG_NET_MAX_CONTEXTS=16
CONFIG_NET_MAX_CONN=15


#monitoring
CONFIG_NET_BUF_POOL_USAGE=y
CONFIG_NET_STATISTICS=y

#-------------------------------------
#CONFIG_REQUIRES_FULL_LIBC=y
# Sockets
CONFIG_NET_SOCKETS=y
CONFIG_NET_SOCKETS_SERVICE=y
CONFIG_ZVFS_POLL_MAX=6
# SNTP
CONFIG_SNTP=y

CONFIG_DNS_RESOLVER=y
CONFIG_ZVFS_EVENTFD_MAX=6
CONFIG_NET_LOG=y
CONFIG_LOG_BACKEND_NET=y
#CONFIG_POSIX_C_LANG_SUPPORT_R=y
#CONFIG_DNS_RESOLVER_ADDITIONAL_BUF_CTR=10
#CONFIG_DNS_RESOLVER_MAX_SERVERS=5
# Пулы пакетов
CONFIG_NET_PKT_RX_COUNT=24
CONFIG_NET_PKT_TX_COUNT=24

# Пулы буферов (минимум)
CONFIG_NET_BUF_RX_COUNT=48
CONFIG_NET_BUF_TX_COUNT=48

# Фрагменты данных (у тебя 128 байт на фрагмент — это ок)
# Увеличим количество фрагментов, чтобы не задыхался TCP
#CONFIG_NET_BUF_DATA_COUNT=128
# CONFIG_NET_BUF_DATA_SIZE=128  # (оставь по умолчанию, если не менял)

# Сервис сокетов — больше стек
CONFIG_NET_SOCKETS_SERVICE_STACK_SIZE=2048

# Стек сетевых потоков
CONFIG_NET_RX_STACK_SIZE=2048
CONFIG_NET_TX_STACK_SIZE=2048

CONFIG_REBOOT=y

CONFIG_COMPILER_OPT="-Og"
CONFIG_DEBUG_OPTIMIZATIONS=y

#CONFIG_LOG_DEFAULT_LEVEL=4
#CONFIG_NET_HTTP_SERVER_LOG_LEVEL=4
#CONFIG_NET_HTTP_LOG_LEVEL=4
#CONFIG_NET_HTTP_LOG_LEVEL_DEFAULT=n
#CONFIG_NET_HTTP_SERVER_LOG_LEVEL_DBG=y
#CONFIG_NET_HTTP_SERVER_LOG_LEVEL=4

CONFIG_DEBUG=y
CONFIG_HTTP_PARSER_URL=y
CONFIG_HTTP_PARSER=y
CONFIG_HTTP_SERVER=y
CONFIG_HTTP_SERVER_RESOURCE_WILDCARD=y
CONFIG_BASE64=y

CONFIG_I2C=y
CONFIG_I2C_SHELL=y
CONFIG_DISPLAY=y
CONFIG_SSD1306=y

CONFIG_MQTT_LIB=y

# File system backend
#CONFIG_LOG_BACKEND_FS=y
#CONFIG_LOG_BACKEND_FS_OVERWRITE=y
#CONFIG_LOG_BACKEND_FS_FILE_PREFIX="log"
#CONFIG_LOG_BACKEND_FS_DIR="/lfs/log"
#CONFIG_LOG_BACKEND_FS_FILE_SIZE=4096
#CONFIG_LOG_BACKEND_FS_FILES_LIMIT=10
#CONFIG_LOG_BACKEND_FS_OUTPUT_TEXT=y

CONFIG_TIMESLICING=y
CONFIG_TIMESLICE_SIZE=20
CONFIG_TIMESLICE_PRIORITY=0

CONFIG_THREAD_RUNTIME_STATS=y
CONFIG_THREAD_NAME=y